(()=>{function Ue(){}Ue.prototype.encode=function(t){for(var e=[],r=t.length,i=0;i<r;){var s=t.codePointAt(i),n=0,o=0;for(s<=127?(n=0,o=0):s<=2047?(n=6,o=192):s<=65535?(n=12,o=224):s<=2097151&&(n=18,o=240),e.push(o|s>>n),n-=6;n>=0;)e.push(128|s>>n&63),n-=6;i+=s>=65536?2:1}return e};function Fe(){}Fe.prototype.decode=function(t){var e="",r=0;if(!t)return"";for(;r<t.length;){var i=t[r],s=0,n=0;if(i<=127?(s=0,n=i&255):i<=223?(s=1,n=i&31):i<=239?(s=2,n=i&15):i<=244&&(s=3,n=i&7),t.length-r-s>0)for(var o=0;o<s;)i=t[r+o+1],n=n<<6|i&63,o+=1;else n=65533,s=t.length-r;e+=String.fromCodePoint(n),r+=s+1}return e};globalThis.TextDecoder=Fe;globalThis.TextEncoder=Ue;function ke(){}var pt={},u,X=null;function J(){return(X===null||X.byteLength===0)&&(X=new Uint8Array(u.memory.buffer)),X}function nt(t,e){return t=t>>>0,J().subarray(t/1,t/1+e)}var v=new Array(128).fill(void 0);v.push(void 0,null,!0,!1);function C(t){return v[t]}var $=v.length;function ot(t){t<132||(v[t]=$,$=t)}function De(t){let e=C(t);return ot(t),e}var Qe=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&Qe.decode();function qe(t,e){return t=t>>>0,Qe.decode(J().subarray(t,t+e))}function y(t){$===v.length&&v.push(v.length+1);let e=$;return $=v[e],v[e]=t,e}var H=null;function at(){return(H===null||H.byteLength===0)&&(H=new Float32Array(u.memory.buffer)),H}var x=0;function A(t,e){let r=e(t.length*4,4)>>>0;return at().set(t,r/4),x=t.length,r}var fe=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},ut=typeof fe.encodeInto=="function"?function(t,e){return fe.encodeInto(t,e)}:function(t,e){let r=fe.encode(t);return e.set(r),{read:t.length,written:r.length}};function lt(t,e,r){if(r===void 0){let a=fe.encode(t),p=e(a.length,1)>>>0;return J().subarray(p,p+a.length).set(a),x=a.length,p}let i=t.length,s=e(i,1)>>>0,n=J(),o=0;for(;o<i;o++){let a=t.charCodeAt(o);if(a>127)break;n[s+o]=a}if(o!==i){o!==0&&(t=t.slice(o)),s=r(s,i,i=o+t.length*3,1)>>>0;let a=J().subarray(s+o,s+i),p=ut(t,a);o+=p.written}return x=o,s}var j=null;function We(){return(j===null||j.byteLength===0)&&(j=new Int32Array(u.memory.buffer)),j}var ce=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){let e=this.__destroy_into_raw();u.__wbg_audioinfo_free(e)}get samples_processed(){return u.__wbg_get_audioinfo_samples_processed(this.__wbg_ptr)>>>0}set samples_processed(e){u.__wbg_set_audioinfo_samples_processed(this.__wbg_ptr,e)}static new(e,r,i){let s=A(r,u.__wbindgen_export_0),n=x,o=A(i,u.__wbindgen_export_0),a=x,p=u.audioinfo_new(e,s,n,o,a);return t.__wrap(p)}get voice_levels(){let e=u.audioinfo_voice_levels(this.__wbg_ptr);return De(e)}get volume_levels(){let e=u.audioinfo_volume_levels(this.__wbg_ptr);return De(e)}},pe=class t{static __wrap(e){e=e>>>0;let r=Object.create(t.prototype);return r.__wbg_ptr=e,r}__destroy_into_raw(){let e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){let e=this.__destroy_into_raw();u.__wbg_audioprocessingstruct_free(e)}static new(e){let r=u.audioprocessingstruct_new(e);return t.__wrap(r)}smart_denoise(e,r){var i=A(e,u.__wbindgen_export_0),s=x,n=A(r,u.__wbindgen_export_0),o=x;let a=u.audioprocessingstruct_smart_denoise(this.__wbg_ptr,i,s,y(e),n,o,y(r));return ce.__wrap(a)}simple_denoise(e,r){var i=A(e,u.__wbindgen_export_0),s=x,n=A(r,u.__wbindgen_export_0),o=x;return u.audioprocessingstruct_simple_denoise(this.__wbg_ptr,i,s,y(e),n,o,y(r))}get_audio_info(e){var r=A(e,u.__wbindgen_export_0),i=x;let s=u.audioprocessingstruct_get_audio_info(this.__wbg_ptr,r,i,y(e));return ce.__wrap(s)}static get_frame_size(){return u.audioprocessingstruct_get_frame_size()>>>0}};async function ft(t,e){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,e)}catch(i){if(t.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}let r=await t.arrayBuffer();return await WebAssembly.instantiate(r,e)}else{let r=await WebAssembly.instantiate(t,e);return r instanceof WebAssembly.Instance?{instance:r,module:t}:r}}function Ye(){let t={};return t.wbg={},t.wbg.__wbindgen_copy_to_typed_array=function(e,r,i){new Uint8Array(C(i).buffer,C(i).byteOffset,C(i).byteLength).set(nt(e,r))},t.wbg.__wbindgen_object_drop_ref=function(e){De(e)},t.wbg.__wbg_buffer_085ec1f694018c4f=function(e){let r=C(e).buffer;return y(r)},t.wbg.__wbg_newwithbyteoffsetandlength_69193e31c844b792=function(e,r,i){let s=new Float32Array(C(e),r>>>0,i>>>0);return y(s)},t.wbg.__wbg_new_d086a66d1c264b3f=function(e){let r=new Float32Array(C(e));return y(r)},t.wbg.__wbg_new_abda76e883ba8a5f=function(){let e=new Error;return y(e)},t.wbg.__wbg_stack_658279fe44541cf6=function(e,r){let i=C(r).stack,s=lt(i,u.__wbindgen_export_0,u.__wbindgen_export_2),n=x;We()[e/4+1]=n,We()[e/4+0]=s},t.wbg.__wbg_error_f851667af71bcfc6=function(e,r){let i,s;try{i=e,s=r,console.error(qe(e,r))}finally{u.__wbindgen_export_1(i,s,1)}},t.wbg.__wbindgen_throw=function(e,r){throw new Error(qe(e,r))},t.wbg.__wbindgen_memory=function(){let e=u.memory;return y(e)},t}function Ke(t,e){return u=t.exports,ct.__wbindgen_wasm_module=e,H=null,j=null,X=null,u}function Ge(t){if(u!==void 0)return u;let e=Ye();t instanceof WebAssembly.Module||(t=new WebAssembly.Module(t));let r=new WebAssembly.Instance(t,e);return Ke(r,t)}async function ct(t){if(u!==void 0)return u;typeof t>"u"&&(t=new URL("rnnoise_bg.wasm",pt.url));let e=Ye();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));let{instance:r,module:i}=await ft(await t,e);return Ke(r,i)}var m;(function(t){t[t.ASYNC=0]="ASYNC",t[t.SYNC=1]="SYNC"})(m||(m={}));var D=class{defaultListenerMode;eventListenerMap;constructor(e=m.ASYNC){this.eventListenerMap=new Map,this.defaultListenerMode=e}addEventListener(e,r,i){let s=this.eventListenerMap.get(e);return s||(s=[],this.eventListenerMap.set(e,s)),s.push(this.toConfiguredListener(r,i)),s.sort(this.listenerPriorityComparator),!0}removeEventListener(e,r){let i=this.eventListenerMap.get(e);if(!i)return!1;let s=-1;for(;++s<i.length;)if(i[s].callback===r)return i.splice(s,1),!0;return!1}clearEventListeners(){return this.eventListenerMap.clear(),!0}countListeners(e){let r=this.eventListenerMap.get(e);return r===void 0?0:r.length}emitEvent(e,r){let i=this.eventListenerMap.get(e);return i?(this.runListeners(i,e,r),!0):!1}runListeners(e,r,i){for(let s of e)s.config.mode&m.SYNC?s.callback.call(this,i,r):globalThis.queueMicrotask(()=>s.callback.call(this,i,r))}toConfiguredListener(e,r){return{callback:e,config:{priority:r&&r.priority?r.priority:0,mode:r&&r.mode!==void 0?r.mode:m.ASYNC}}}listenerPriorityComparator(e,r){return e.config.priority===r.config.priority?0:e.config.priority>r.config.priority?-1:1}};var w=class t{static create(){let e={};return new Promise(r=>{e.promise=new Promise((i,s)=>{e.resolve=i,e.reject=s,r(e)})})}static createSync="withResolvers"in Promise?Promise.withResolvers.bind(Promise):t.createSyncImpl;static createSyncImpl(){let e={};return e.promise=new Promise((r,i)=>{e.resolve=r,e.reject=i}),e}};var he=class t{static queueMicrotaskMethod=xt();static queue(e){t.queueMicrotaskMethod(e)}};function xt(){try{return gt()}catch{return yt()}}function gt(){let t;if(window?t=window.queueMicrotask.bind(window):self?t=self.queueMicrotask.bind(self):globalThis&&(t=globalThis.queueMicrotask.bind(globalThis)),t)return t;throw new Error}function yt(){return function(t){Promise.resolve().then(t).catch(e=>setTimeout(()=>{throw e},0))}}var Gi=Symbol.for("AsyncMethodCallQueue"),Xi=Symbol.for("AsyncMethodQueueGroupResolver");var Z=Symbol("clone");function P(t){return typeof t=="object"&&t!==null&&b in t}function me(t,e){return t===e?!0:P(t)?t[b](e):P(e)?e[b](t):!1}var b=Symbol("equals");var ee=Symbol("compareTo");function te(t){return typeof t=="object"&&t!==null&&ee in t}var R=Symbol("compare");var Et=Symbol("instance");var V={application:{"octet-stream":["bin"],javascript:["js"],xml:["xml"],json:["json"],"x-bzip":["bz"],"x-bzip2":["bz2","boz"],msword:["doc","dot"],"vnd.openxmlformats-officedocument.wordprocessingml.document":["docx"],"vnd.ms-fontobject":["eot"],gzip:["gz"],"java-archive":["jar"],"vnd.oasis.opendocument.presentation":["odp"],"vnd.oasis.opendocument.spreadsheet":["ods"],"vnd.oasis.opendocument.text":["odt"],pdf:["pdf"],"vnd.ms-powerpoint":["ppt","pps","pot"],"vnd.openxmlformats-officedocument.presentationml.presentation":["pptx"],"vnd.rar":["rar"],"x-rar-compressed":["rar"],rtf:["rtf"],"x-tar":["tar"],"vnd.ms-excel":["xls","xlm","xla","xlc","xlt","xlw"],"vnd.openxmlformats-officedocument.spreadsheetml.sheet":["xlsx"],zip:["zip"],"x-7z-compressed":["7z"],"vnd.microsoft.portable-executable":["exe","dll"],"application/vnd.android.package-archive":["apk"]},audio:{aac:["aac","adts"],aiff:["aff","aif","aiff"],alac:["m4a","caf"],amr:["amr"],"x-ape":["ape"],flac:["flac"],"x-flac":["flac"],mp4:["m4a","mp4","mpg4"],midi:["midi","mid"],"x-midi":["midi","mid"],mpeg:["mp3","mpga","mp2","mp2a","m2a","m3a"],ogg:["ogg","oga","opus"],opus:["opus","ogg"],wav:["wav","wave"],"x-ms-wma":["wma"],webm:["webm","weba"]},image:{jpeg:["jpeg","jpg"],gif:["gif"],png:["png"],"x-exr":["exr"],webp:["webp"],"vnd.radiance":["hdr","pic","rgbe","xyze"],heif:["heif","hif"],heic:["heic","hif"],avif:["avif","heif","heifs","hif"],tiff:["tif","tiff"],bmp:["bmp","dib"],"vnd.adobe.photoshop":["psd","psb"],"vnd.microsoft.icon":["ico"],"svg+xml":["svg"],"image/x-adobe-dng":["dng"]},video:{webm:["webm"],"x-matroska":["mkv","mk3d","mks"],"x-flv":["flv"],ogg:["ogv"],"x-msvideo":["avi"],mp2t:["ts","tsv","tsa","m2t"],quicktime:["mov","movie","qt","qtvr"],"x-ms-wmv":["wmv"],mp4:["mp4","mp4v","mpg4"],mpeg:["mpg","mpeg","mpe","m1v","m2v"],"3gpp":["3gp","3gpp"]},text:{plain:["txt"],css:["css"],csv:["csv"],html:["html"],calendar:["ics"],javascript:["js","mjs","cjs"]}},vt={bin:"application/octet-stream",js:"application/javascript",json:"application/json",doc:"application/msword",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",pdf:"application/pdf",ppt:"application/vnd.ms-powerpoint",pptx:"application/vnd.openxmlformats-officedocument.presentationml.presentation",rar:"application/vnd.rar",rtf:"application/rtf",xls:"application/vnd.ms-excel",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",zip:"application/zip","7z":"application/x-7z-compressed",aac:"audio/aac",flac:"audio/flac",m4a:"audio/mp4",midi:"audio/midi",mp3:"audio/mpeg",wav:"audio/wav",jpg:"image/jpeg",gif:"image/gif",png:"image/png",webp:"image/webp",heif:"image/heif",heic:"image/heif",svg:"image/svg+xml",dng:"image/x-adobe-dng",webm:"video/webm",mkv:"video/x-matroska",mp4:"video/mp4",txt:"text/plain",csv:"text/csv"};function je(t){t[0]==="."&&(t=t.slice(1)),t=t.toLowerCase();let e=vt[t];if(e!==void 0)return e;for(let r in V)for(let i in V[r])if(V[r][i].indexOf(t)!==-1)return r+"/"+i;return null}function Je(t,e){let r=Pe(t,e);return!r||!r[0]?null:r[0]}function Pe(t,e){return!V.hasOwnProperty(t)||!V[t].hasOwnProperty(e)?null:V[t][e]}var _=class t{static FULL_MIME_STRING_REGEXP=/^(.+?)\/(.+?)(?:\u0020*;\u0020*(.+)|$)/;static MIME_PARAMS_REGEXP=/\u0020*(.*?)=(.+?)\u0020*(?:;|$)/g;static defaultMimeTypeInstance=null;type;subtype;params;constructor(e,r,i=null){this.type=e.toLowerCase(),this.subtype=r,this.params=i}static getDefault(){return t.defaultMimeTypeInstance===null&&(t.defaultMimeTypeInstance=new t("application","octet-stream")),t.defaultMimeTypeInstance}static parse(e){let r=e.match(t.FULL_MIME_STRING_REGEXP);if(r===null)throw new TypeError("Invalid mime type!");let[,i,s,n]=r;return n===void 0?new t(i,s):new t(i,s,this.parseParamsString(n))}static parseParamsString(e){let r=[],i=e.matchAll(t.MIME_PARAMS_REGEXP),s;for(;!(s=i.next()).done;)r.push([s.value[1],s.value[2]]);return r}static fromFileExtension(e){let r=je(e);if(r===null)return t.getDefault();let i=r.indexOf("/");if(i===-1)throw new TypeError("Invalid mime type!");return new t(r.slice(0,i),r.slice(i+1))}getPreferredFileExtension(){return Je(this.type,this.subtype)}getFileExtensions(){return Pe(this.type,this.subtype)}isApplication(){return this.type==="application"}isAudio(){return this.type==="audio"}isFont(){return this.type==="font"}isExample(){return this.type==="example"}isImage(){return this.type==="image"}isMessage(){return this.type==="message"}isModel(){return this.type==="model"}isMultipart(){return this.type==="multipart"}isText(){return this.type==="text"}isVideo(){return this.type==="video"}getType(){return this.type}getSubtype(){return this.subtype}getParameters(){return this.params}toString(){return this.type+"/"+this.subtype+this.paramsToString()}paramsToString(){if(!this.params)return"";let e="";for(let r of this.params)e+="; "+r[0]+"="+r[1];return e}};var l=class extends Error{name="TCException";constructor(e,r){super(e,{cause:r}),arguments.length===2&&r!==void 0&&this.cause===void 0&&(this.cause=r)}};var z=class extends l{name="TCNullReferenceException";constructor(e,r){super(e===void 0?"Null reference":e,r)}};var S=class extends l{name="TCNoSuchElementException";constructor(e,r){super(e,r)}};var U=class extends l{name="TCValidationException";constructor(e,r){super(e,r)}};var xe=class t{static DECODE_TABLE=[255,255,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255,255,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,255,255,255,255,255];static HEX_DECODE_TABLE=[0,1,2,3,4,5,6,7,8,9,255,255,255,255,255,255,255,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255,255,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,255,255,255,255,255,255,255,255,255];static ENCODE_TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567";static HEX_ENCODE_TABLE="0123456789ABCDEFGHIJKLMNOPQRSTUV";static utf8Decoder=new TextDecoder("utf-8");value;decodeTable;encodeTable;constructor(e,r=!1){this.value=e,r?(this.decodeTable=t.HEX_DECODE_TABLE,this.encodeTable=t.HEX_ENCODE_TABLE):(this.decodeTable=t.DECODE_TABLE,this.encodeTable=t.ENCODE_TABLE)}static fromString(e,r=!1){let i=e.length,s=new Uint8Array(i);for(let n=0;n<i;n++)s[n]=e.charCodeAt(n);return this.fromTypedArray(s,r)}static async fromBlob(e,r=!1){let i=await e.arrayBuffer();return this.fromArrayBuffer(i,r)}static fromArrayBuffer(e,r=!1){return this.fromTypedArray(new Uint8Array(e),r)}static fromTypedArray(e,r=!1){e instanceof Uint8Array||(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength));let i=new t("",r).encode(e);return new t(this.utf8Decoder.decode(i),r)}getValue(){return this.value}toBlob(e){e||(e=_.getDefault().toString());let r=this.toArrayBuffer(),i={};return e!==void 0&&(i.type=e),new Blob([r],i)}toArrayBuffer(){return this.toUint8Array().buffer}toUint8Array(){return this.decode(this.value)}static quintetCount(e){let r=Math.floor(e.length/5);return e.length%5===0?r:r+1}decode(e){let r;typeof e=="string"?r=t.stringToBuffer(e):r=e;let i=0,s=0,n=0,o=0,a=new Uint8Array(Math.ceil(r.length*5/8));for(let p=0;p<r.length&&r[p]!==61;p++){let T=r[p]-48;if(T<this.decodeTable.length)s=this.decodeTable[T],i<=3?(i=(i+5)%8,i===0?(n|=s,a[o]=n,o++,n=0):n|=255&s<<8-i):(i=(i+5)%8,n|=255&s>>>i,a[o]=n,o++,n=255&s<<8-i);else throw new U("Invalid input - it is not base32 encoded string")}return a.slice(0,o)}encode(e){let r;typeof e=="string"?r=t.stringToBuffer(e):r=e;let i=0,s=0,n=0,o=0,a=new Uint8Array(t.quintetCount(r)*8);for(;i<r.length;){let p=r[i];n>3?(o=p&255>>n,n=(n+5)%8,o=o<<n|(i+1<r.length?r[i+1]:0)>>8-n,i++):(o=p>>8-(n+5)&31,n=(n+5)%8,n===0&&i++),a[s]=this.encodeTable.charCodeAt(o),s++}for(i=s;i<a.length;i++)a[i]=61;return a}toString(){return this.value}static stringToBuffer(e){let r=e.length,i=new Uint8Array(r);for(let s=0;s<r;s++)i[s]=e.charCodeAt(s);return i}};var ge=class{static alphabet="0123456789abcdef";static encodeLookup=[];static decodeLookup=[];static{for(let e=0;e<256;e++)this.encodeLookup[e]=this.alphabet[e>>4&15]+this.alphabet[e&15],e<16&&(e<10?this.decodeLookup[48+e]=e:this.decodeLookup[87+e]=e)}static binary2HexString(e){let r=e.length,i="",s=0;for(;s<r;)i+=this.encodeLookup[e[s++]];return i}static hexString2Binary(e){e=e.toLowerCase();let r=e.length>>1,i=r<<1,s=new Uint8Array(r),n=0,o=0;for(;o<i;)s[n++]=this.decodeLookup[e.charCodeAt(o++)]<<4|this.decodeLookup[e.charCodeAt(o++)];return s}constructor(){}};var re=class t{value;isValueProvided;constructor(e){this.value=e,this.isValueProvided=arguments.length===1}static empty(){return new t}static of(e){if(arguments.length===0)throw new z;return new t(e)}static ofNullable(e,r){return arguments.length===0||r===e?t.empty():t.of(e)}get(){if(!this.isValueProvided)throw new S("No value present");return this.value}isPresent(){return this.isValueProvided}isEmpty(){return!this.isValueProvided}ifPresent(e){this.isValueProvided&&e(this.value)}ifPresentOrElse(e,r){this.isValueProvided?e(this.value):r()}filter(e){return this.isValueProvided?e(this.value)?this:t.empty():this}or(e){return this.isValueProvided?this:e()}orElse(e){return this.isValueProvided?this.value:e}orElseGet(e){return this.isValueProvided?this.value:e()}orElseThrow(e){if(this.isValueProvided)return this.value;throw e?e instanceof Error?e:new e:new S}toString(){return this.isValueProvided?"Optional["+this.value+"]":"Optional.empty"}[b](e){return this===e?!0:e instanceof t?this.value===e.value?!0:P(this.value)&&P(e.value)?this.value[b](e.value):this.value===e.value:!1}[Z](){return new t(this.value)}};var no=Symbol("lazyProperties");var ye=class t{min;max;comparator;constructor(e,r,i=new Re){this.comparator=i,i[R](e,r)<1?(this.min=e,this.max=r):(this.min=r,this.max=e)}static between(e,r,i){return new t(e,r,i)}getMinimum(){return this.min}getMaximum(){return this.max}getComparator(){return this.comparator}contains(e){return this.comparator[R](e,this.min)>-1&&this.comparator[R](e,this.max)<1}containsRange(e){return this.contains(e.min)&&this.contains(e.max)}[Z](){return new t(this.min,this.max,this.comparator)}[b](e){return this===e?!0:e instanceof t?me(this.min,e.min)&&me(this.max,e.max)&&me(this.comparator,e.comparator):!1}toJSON(){return{min:this.valueToJsonValue(this.min),max:this.valueToJsonValue(this.max)}}toString(){return"Range[min="+this.min+", max="+this.max+"]"}valueToJsonValue(e){if(typeof e=="bigint")throw new TypeError("Do not know how to serialize bigint");if(te(e))throw new TypeError("Do not know how to serialize Comparable");return e}},Re=class{[R](e,r){if((typeof e=="number"||typeof e=="bigint")&&(typeof r=="number"||typeof r=="bigint"))return e<r?-1:e>r?1:0;if(typeof e=="string"&&typeof r=="string")return e.localeCompare(r);if(te(e))return e[ee](r);if(te(r))return r[ee](e);throw new TypeError("Unable to compare variables with different types!")}};var ie;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.IA32=1]="IA32",t[t.X86_64=2]="X86_64",t[t.ARM=3]="ARM",t[t.ARM64=4]="ARM64",t[t.MIPS=5]="MIPS"})(ie||(ie={}));var M;(function(t){function e(r){return/win/i.test(r)?t.WINDOWS:/linux/i.test(r)?t.LINUX:/mac|darwin/i.test(r)?t.MAC:/ios|iphone|ipad/i.test(r)?t.IOS:/Android/i.test(r)?t.ANDROID:/Chrome|Chromium/i.test(r)?t.CHROME_OS:/FreeBSD/i.test(r)?t.FREE_BSD:/OpenBSD/i.test(r)?t.OPEN_BSD:/Solaris/i.test(r)?t.SOLARIS:/Fuchsia/i.test(r)?t.FUCHSIA:t.UNKNOWN}t.fromName=e})(M||(M={}));(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WINDOWS=1]="WINDOWS",t[t.LINUX=2]="LINUX",t[t.MAC=3]="MAC",t[t.IOS=4]="IOS",t[t.ANDROID=5]="ANDROID",t[t.CHROME_OS=6]="CHROME_OS",t[t.FREE_BSD=7]="FREE_BSD",t[t.OPEN_BSD=8]="OPEN_BSD",t[t.SOLARIS=9]="SOLARIS",t[t.FUCHSIA=10]="FUCHSIA"})(M||(M={}));var se;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.BROWSER=1]="BROWSER",t[t.NODE=2]="NODE",t[t.DENO=3]="DENO"})(se||(se={}));var ne=class extends D{constructor(r){super();this.messagePort=r;this.onOriginalPortMessage=this.onOriginalPortMessage.bind(this),this.messagePort.onmessage=this.onOriginalPortMessage,this.messageAsyncQueue=new Map}messageAsyncQueue;async sendCommand(r,i,s={}){let n={command:r,value:i},o=await w.create();return this.messagePort.postMessage(n,s),this.messageAsyncQueue.set(r,o),o.promise}answerCommand(r,i,s={}){let n={command:r,value:i};this.messagePort.postMessage(n,s)}onOriginalPortMessage(r){let i=this.messageAsyncQueue.get(r.data.command);if(i){i.resolve(r.data.value);return}this.emitEvent(r.data.command,r.data.value)}};var Ve=Symbol("clone");function Ee(t){return typeof t=="object"&&t!==null&&oe in t}var oe=Symbol("equals");var St=Symbol("compareTo");var I=Symbol("compare");var f=class extends Error{name="TCException";constructor(e,r){super(e,{cause:r}),arguments.length===2&&r!==void 0&&this.cause===void 0&&(this.cause=r)}};var L=class extends f{name="TCNullReferenceException";constructor(e,r){super(e===void 0?"Null reference":e,r)}};var E=class extends f{name="TCIllegalArgumentException";constructor(e,r){super(e,r)}};var O=class extends f{name="TCNoSuchElementException";constructor(e,r){super(e,r)}};var ae=class t{value;isValueProvided;constructor(e){this.value=e,this.isValueProvided=arguments.length===1}static empty(){return new t}static of(e){if(arguments.length===0)throw new L;return new t(e)}static ofNullable(e,r){return arguments.length===0||r===e?t.empty():t.of(e)}get(){if(!this.isValueProvided)throw new O("No value present");return this.value}isPresent(){return this.isValueProvided}isEmpty(){return!this.isValueProvided}ifPresent(e){this.isValueProvided&&e(this.value)}ifPresentOrElse(e,r){this.isValueProvided?e(this.value):r()}filter(e){return this.isValueProvided?e(this.value)?this:t.empty():this}or(e){return this.isValueProvided?this:e()}orElse(e){return this.isValueProvided?this.value:e}orElseGet(e){return this.isValueProvided?this.value:e()}orElseThrow(e){if(this.isValueProvided)return this.value;throw e?e instanceof Error?e:new e:new O}toString(){return this.isValueProvided?"Optional["+this.value+"]":"Optional.empty"}[oe](e){return this===e?!0:e instanceof t?this.value===e.value?!0:Ee(this.value)&&Ee(e.value)?this.value[oe](e.value):this.value===e.value:!1}[Ve](){return new t(this.value)}};var bl=Symbol("lazyProperties");function tt(t){return t==null||t===!1||t===!0||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="bigint"}function F(t){return!tt(t)}var q=class{observerList;notifyObservers=this.notifyNothing;constructor(){}get numObservers(){return this.observerList!==void 0?this.observerList.length:0}addObserver(e){this.observerList===void 0?(this.observerList=[e],this.notifyObservers=this.notifySingleObserver):this.observerList.indexOf(e)===-1&&(this.observerList.push(e),this.notifyObservers=this.notifyObserverList)}removeObserver(e){if(this.observerList===void 0)return;if(this.observerList.length===1){this.observerList=void 0,this.notifyObservers=this.notifyNothing;return}let r=this.observerList.indexOf(e);r!=-1&&this.observerList.splice(r,1)}hasObserver(e){return this.observerList===void 0?!1:this.observerList.indexOf(e)!==-1}notifySingleObserver(e){this.observerList[0].call(this,e)}notifyObserverList(e){for(let r of this.observerList)r.call(this,e)}notifyNothing(e){}};var ue;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.IA32=1]="IA32",t[t.X86_64=2]="X86_64",t[t.ARM=3]="ARM",t[t.ARM64=4]="ARM64",t[t.MIPS=5]="MIPS"})(ue||(ue={}));var B;(function(t){function e(r){return/win/i.test(r)?t.WINDOWS:/linux/i.test(r)?t.LINUX:/mac|darwin/i.test(r)?t.MAC:/ios|iphone|ipad/i.test(r)?t.IOS:/Android/i.test(r)?t.ANDROID:/Chrome|Chromium/i.test(r)?t.CHROME_OS:/FreeBSD/i.test(r)?t.FREE_BSD:/OpenBSD/i.test(r)?t.OPEN_BSD:/Solaris/i.test(r)?t.SOLARIS:/Fuchsia/i.test(r)?t.FUCHSIA:t.UNKNOWN}t.fromName=e})(B||(B={}));(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.WINDOWS=1]="WINDOWS",t[t.LINUX=2]="LINUX",t[t.MAC=3]="MAC",t[t.IOS=4]="IOS",t[t.ANDROID=5]="ANDROID",t[t.CHROME_OS=6]="CHROME_OS",t[t.FREE_BSD=7]="FREE_BSD",t[t.OPEN_BSD=8]="OPEN_BSD",t[t.SOLARIS=9]="SOLARIS",t[t.FUCHSIA=10]="FUCHSIA"})(B||(B={}));var le;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.BROWSER=1]="BROWSER",t[t.NODE=2]="NODE",t[t.DENO=3]="DENO"})(le||(le={}));var N=class extends q{equalizer;bufferSize;constructor(e,r){super(),this.bufferSize=e,this.equalizer=r}getBufferSize(){return this.bufferSize}setBufferSize(e){if(e<0)throw new E;this.bufferSize=e}},g;(function(t){t[t.ROUGH=0]="ROUGH",t[t.SMOOTH=1]="SMOOTH"})(g||(g={}));var W=class t{bufferCtor;internalBuffer;capacityValue;sizeValue;extensionRate=2;constructor(e,r){this.bufferCtor=e,this.internalBuffer=new e(r||0),this.capacityValue=this.internalBuffer.length,this.sizeValue=this.internalBuffer.length}static withCapacity(e,r){let i=new t(e,r);return i.sizeValue=0,i}get buffer(){return this.internalBuffer}clear(){return this.internalBuffer=new this.bufferCtor,this.sizeValue=0,this.capacityValue=0,this.internalBuffer}resize(e){if(e<this.internalBuffer.length){this.internalBuffer=this.internalBuffer.slice(0,e),this.capacityValue=e,this.sizeValue=e;return}if(e===this.internalBuffer.length)return;let r=new this.bufferCtor(this.internalBuffer,0,e);this.capacityValue=e,this.sizeValue=this.internalBuffer.length,this.internalBuffer=r}splitOffBefore(e){let[r,i]=this.baseSplit(e);return this.internalBuffer=i,this.sizeValue=i.length,this.capacityValue=i.length,r}splitOffAfter(e){let[r,i]=this.baseSplit(e);return this.internalBuffer=r,this.sizeValue=r.length,this.capacityValue=r.length,i}baseSplit(e){if(e>this.sizeValue)throw"error";let r=this.internalBuffer.slice(0,e),i=this.internalBuffer.slice(e,this.sizeValue);return[r,i]}get capacity(){return this.capacityValue}get size(){return this.sizeValue}append(e){if(this.sizeValue+e.length<=this.capacityValue){this.internalBuffer.set(e,this.sizeValue),this.sizeValue+=e.length;return}let r=new this.bufferCtor(this.sizeValue+e.length),i=this.internalBuffer.slice(0,this.sizeValue);r.set(i,0),r.set(e,i.length),this.sizeValue=r.length,this.capacityValue=r.length,this.internalBuffer=r}trimToSize(){this.internalBuffer=this.internalBuffer.slice(0,this.sizeValue),this.capacityValue=this.sizeValue}};var ve=class extends N{mode=g.ROUGH;sampleBuffer;sampleRate;constructor(e){super(e.getBufferSize(),e.getEqualizer()),this.sampleRate=we,this.sampleBuffer=W.withCapacity(Float32Array,this.bufferSize*this.sampleRate/1e3),this.setBufferSize=this.setBufferSize.bind(this)}pushSamples(e,r,i,s){this.sampleRate=e,this.assertsInputOutputLength(i,s);let n=i.length/e*1e3,o=this.sampleBuffer.size/e*1e3,a=i,p=s;if(this.bufferSize===0){p.set(a);return}if(n+o<this.bufferSize){this.sampleBuffer.append(a);return}this.sampleBuffer.append(a),p.set(this.sampleBuffer.splitOffBefore(p.length))}clear(){this.sampleBuffer.clear()}getCurrentDelay(){return this.sampleBuffer.size}setBufferSize(e){super.setBufferSize(e),this.sampleBuffer.splitOffAfter(e*this.sampleRate)}assertsInputOutputLength(e,r){if(e.length!==r.length)throw new E}};var rt;(function(t){t[t.FORWARD=0]="FORWARD",t[t.REVERSE=1]="REVERSE"})(rt||(rt={}));var Q=class t{queueArray;constructor(e){this.queueArray=e!==void 0?[...e]:[]}dequeue(){let e=this.queueArray.shift();return e!==void 0?e:null}enqueue(e){this.queueArray.push(e)}peek(){return this.queueArray.length!==0?this.queueArray[0]:null}clear(){this.queueArray=[]}clone(){return new t(this)}getSize(){return this.queueArray.length}isEmpty(){return this.queueArray.length===0}getIterator(){return this.queueArray[Symbol.iterator]()}[Symbol.iterator](){return this.queueArray[Symbol.iterator]()}};var Y=class t{littleEndian;static BIG_ENDIAN=new t(!1);static LITTLE_ENDIAN=new t(!0);static nativeOrder(){return Dt()?this.LITTLE_ENDIAN:this.BIG_ENDIAN}static isLittleEndian(e){return e.littleEndian}static isBigEndian(e){return!e.littleEndian}constructor(e){this.littleEndian=e}isLittleEndian(){return this.littleEndian}isBigEndian(){return!this.littleEndian}},Dt=(()=>{let t;function e(){let r=new Uint32Array([3238002414]),i=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);if(i[0]===238)return!0;if(i[0]===192)return!1;throw new TypeError("Unknown byte endianness")}return()=>(t===void 0&&(t=e()),t)})();function be(t){return t===Int8Array||t===Uint8Array||t===Uint8ClampedArray||t===Int16Array||t===Uint16Array||t===Int32Array||t===Uint32Array||t===Float32Array||t===Float64Array||t===BigInt64Array?!0:t===BigUint64Array}var Rt=Symbol("ComparableValueValidatorMethodTag"),c=Rt;var d=class t{[I](e,r){if(!this.checkIsComparableValue(e)||!this.checkIsComparableValue(r))throw new TypeError("Unsupported typed array type!");if(e===r)return 0;if(e.byteLength!=r.byteLength)return e.byteLength-r.byteLength;if(e.buffer===r.buffer&&e.byteOffset===r.byteOffset)return 0;for(let i=0;i<e.length;i++)if(e[i]!==r[i])return e[i]-r[i];return 0}static isTypedArrayComparator(e,r){if(!F(e)||!(I in e)||!(c in e)||typeof e[c]!="function")return!1;let i=e[c]();return!F(i)||!(i instanceof Array)?!1:this.findValidTypedArrayCtor(i,s=>s===r)}checkIsComparableValue(e){return F(e)?t.findValidTypedArrayCtor(this[c](),r=>e instanceof r):!1}static findValidTypedArrayCtor(e,r){if(!F(e)||!(e instanceof Array))return!1;for(let i of e)if(typeof i=="function"&&be(i)&&r(i))return!0;return!1}};var k=class extends d{[c](){return[Uint8Array,Uint8ClampedArray]}};var Te=class t{uint8Comparator;constructor(){this.uint8Comparator=new k}static isArrayBufferComparator(e){return e instanceof t}[I](e,r){let i=new Uint8Array(e),s=new Uint8Array(r);return this.uint8Comparator[I](i,s)}};var Ce=class extends d{[c](){return[Int8Array]}};var _e=class extends d{[c](){return[Uint16Array]}};var Le=class extends d{[c](){return[Int16Array]}};var Ae=class extends d{[c](){return[Uint32Array]}};var Se=class extends d{[c](){return[Int32Array]}};var Me=class extends d{[c](){return[BigUint64Array]}};var Ie=class extends d{[c](){return[BigInt64Array]}};var Oe=class extends d{[c](){return[Float32Array]}};var Be=class extends d{[c](){return[Float64Array]}};var Ne=class extends N{mode=g.SMOOTH;voiceIterCounter=0;config={silenceAccumulationFactor:8,voiceAccumulationFactor:4,silenceShrinkFactor:2,voiceShrinkFactor:2};voiceQueue=new Q;sampleBuffer;constructor(e){super(e.getBufferSize(),e.getEqualizer()),this.sampleBuffer=W.withCapacity(Float32Array,this.bufferSize*we/1e3)}pushSamples(e,r,i,s){this.assertsInputOutputLength(i,s),this.voiceQueue.enqueue(r);let n=i,o=s,a=this.sampleBuffer.size/e*1e3,p=n.length/e*1e3;a+p<this.bufferSize?(this.sampleBuffer.append(n),this.smartIncrease(e,n,o)):a>1.5*this.bufferSize?(this.smartDecrease(e,n,o),this.sampleBuffer.append(n),o.set(this.sampleBuffer.splitOffBefore(o.length))):(this.voiceIterCounter=0,this.voiceQueue.dequeue(),this.sampleBuffer.append(n),o.set(this.sampleBuffer.splitOffBefore(o.length)))}smartDecrease(e,r,i){let s=this.voiceQueue.dequeue(),n=this.voiceQueue.dequeue();if(s||n){let o=this.sampleBuffer.splitOffBefore(r.length*this.config.voiceShrinkFactor);this.equalizer.equalize(o,i,o.length/e,i.length/e)}else{let o=r.length*this.config.silenceShrinkFactor;for(;this.sampleBuffer.size/e>this.bufferSize||!s||!n;){if(this.sampleBuffer.size<o){this.sampleBuffer.clear();return}this.sampleBuffer.splitOffBefore(o),s=this.voiceQueue.dequeue(),n=this.voiceQueue.dequeue()}if(s||n){let a=this.sampleBuffer.splitOffBefore(r.length*this.config.voiceShrinkFactor);this.equalizer.equalize(a,i,a.length/e,i.length/e)}}}smartIncrease(e,r,i){if(this.voiceQueue.peek()){this.incrementCounterUntil(this.config.voiceAccumulationFactor);let n=this.sampleBuffer.splitOffBefore(r.length/this.config.voiceAccumulationFactor);this.equalizer.equalize(n,i,n.length/e,i.length/e)}else{this.incrementCounterUntil(this.config.silenceAccumulationFactor);let n=this.sampleBuffer.splitOffBefore(r.length/this.config.silenceAccumulationFactor);this.equalizer.equalize(n,i,n.length/e,i.length/e)}}incrementCounterUntil(e){this.voiceIterCounter<e-1?++this.voiceIterCounter:(this.voiceIterCounter=0,this.voiceQueue.dequeue())}clear(){this.sampleBuffer.clear()}setBufferSize(e){super.setBufferSize(e),this.voiceIterCounter=0}getCurrentDelay(){return this.sampleBuffer.size}assertsInputOutputLength(e,r){if(e.length!==r.length)throw new E}};var we=48e3,K=class{equalizer=null;playbackMode=null;sizeInMs=null;constructor(){}setPlaybackMode(e){return this.playbackMode=e,this}getPlaybackMode(){return this.playbackMode}setBufferSize(e){return this.sizeInMs=e,this}getBufferSize(){return this.sizeInMs}setEqualizer(e){return this.equalizer=e,this}getEqualizer(){return this.equalizer}build(){return this.assertNullableFields(),this.playbackMode===g.SMOOTH?new Ne(this):new ve(this)}assertNullableFields(){if(!this.equalizer||this.playbackMode===null||!this.sizeInMs)throw new L}};var G=class{equalize(e,r,i,s){e.length<r.length?this.increase(e,r):e.length>r.length&&this.decrease(e,r)}increase(e,r){if(r.length%e.length!==0)throw new RangeError;let i=[],s=r.length/e.length;for(let n=0;n<e.length;n++){let o=e[n],a=e[n+1];if(i.push(o),a===void 0){for(let T=0;T<s-1;T++)i.push(o);r.set(i,0);return}let p=(a-o)/s;for(let T=0;T<s-1;T++)i.push(o+p)}if(r.length!==i.length)throw new RangeError;r.set(i,0)}decrease(e,r){if(e.length%r.length!==0)throw new RangeError;let i=e.length/r.length,s=[];for(let n=0;n<e.length;n+=i){let o=0,a=0;for(a=0;a<i;a++)o+=e[n+a];s.push(o/a)}if(r.length!==s.length)throw new RangeError;r.set(s)}};var ze=class extends AudioWorkletProcessor{audioProcessingStruct;sampleBuffer;denoiseEnabled=!1;working=!0;lastHasVoice=!1;messagePort;constructor(e){super();let r=e.processorOptions.wasmModule;ke(),Ge(r),this.audioProcessingStruct=pe.new(this.denoiseEnabled),this.sampleBuffer=e.processorOptions.sampleBuffer,this.messagePort=new ne(this.port),this.onDenoiseStatus=this.onDenoiseStatus.bind(this),this.messagePort.addEventListener("setDenoiseStatus",this.onDenoiseStatus,{mode:m.SYNC}),this.onStop=this.onStop.bind(this),this.messagePort.addEventListener("stop",this.onStop,{mode:m.SYNC}),this.onBufferSize=this.onBufferSize.bind(this),this.messagePort.addEventListener("setBufferSize",this.onBufferSize,{mode:m.SYNC}),this.onSampleBuffer=this.onSampleBuffer.bind(this),this.messagePort.addEventListener("setSampleBuffer",this.onSampleBuffer,{mode:m.SYNC}),this.sampleBuffer=new K().setBufferSize(1e3).setEqualizer(new G).setPlaybackMode(g.SMOOTH).build()}process(e,r,i){if(e.length===0||e[0].length===0)return this.working;let s;if(this.denoiseEnabled)s=this.audioProcessingStruct.smart_denoise(r[0][0],e[0][0]);else if(s=this.audioProcessingStruct.get_audio_info(e[0][0]),this.sampleBuffer)this.sampleBuffer.pushSamples(globalThis.sampleRate,this.lastHasVoice,e[0][0],r[0][0]);else for(let n=0;n<r.length;n++)for(let o=0;o<r[n].length;o++)r[n][o].set(e[n][o]);if(s.samples_processed!==0){let n={samples_processed:s.samples_processed,voice_levels:s.voice_levels,volume_levels:s.volume_levels};this.messagePort.answerCommand("onAudioInfo",n,{transfer:[n.voice_levels.buffer,n.volume_levels.buffer]});let o=0;for(let a of s.voice_levels)o+=a;this.lastHasVoice=o/s.voice_levels.length>.6}return s.free(),this.working}onSampleBuffer(e){this.sampleBuffer=new K().setBufferSize(1e3).setEqualizer(new G).setPlaybackMode(e).build(),this.messagePort.answerCommand("setSampleBuffer",!0)}onStop(){this.working=!1,this.audioProcessingStruct.free(),this.messagePort.answerCommand("stop",this.working)}onBufferSize(e){this.sampleBuffer.setBufferSize(e),this.messagePort.answerCommand("setBufferSize",e)}onDenoiseStatus(e){this.denoiseEnabled=e,this.messagePort.answerCommand("setDenoiseStatus",e)}};registerProcessor("TCAudioWorkletProcessor",ze);})();
